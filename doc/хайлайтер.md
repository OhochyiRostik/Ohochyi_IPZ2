# Зміст
1. [Вступ](#вступ)
2. [Завдання](#завдання)
3. [Основні положення](#положення)
4. [Проектування](#проектування)
5. [Розробка](#розробка)
6. [Тестування](#тестування)
7. [Висновки](#висновки)
8. [Джерела](#джерела)

<a name="вступ"></a>
## Вступ

**Мета:**

Даний документ ставить перед собою мету показати процес створення власного хайлайтера для обраної мови, а саме Data Processing Script, на базі бібліотеки highlight.js.


**Що таке Data Processing Script:**

Data Processing Script - це спеціалізована мова, яка дозволяє описати послідовність дій, пов'язаних з обробкою даних в сервісі обробки, переклавши навантаження по реалізації рутинних обчислень на серверну сторону.

Скрипт являє собою безумовну послідовність команд, які виконуються на неявному контексті скрипта (результати попередніх команд - це контекст, з якого вибираються аргументи наступної команди).

У DPS можна використовувати ін'єкції html, text, xml, csv, json, які перетворюються в відповідні js-типи і об'єкти.


**Що таке Highlight.js:**

Highlight.js - хайлайтер, написаний на JavaScript, працює як у браузері, так і на сервері, може працювати практично з будь-якою розміткою, не залежить від будь-яких інших фреймворків і має автоматичне визначення мови.


**Переваги підсвічування синтаксису:**

Основною первагою підсвічування синтаксису є полегшення розпізнавання синтаксису і структури коду програмістом, це підтверджує дослідження, опубліковане на конференції PPIG, яке оцінило вплив виділення синтаксису на розуміння коротких програм, виявивши, що наявність підсвічування синтаксису значно скорочує час, необхідний програмісту для узагальнення семантики програми. Окрім того, дані, зібрані під час дослідження, що відстежували очі, свідчать про те, що підсвічування синтаксису дозволяє програмістам приділяти менше уваги стандартним синтаксичним компонентам, таким як ключові слова.

До плюсів хайлайтера можна також віднести той факт, що він допомагає зменшити кількість орфографічнох помилок або ж помилок друку в коді, наприклад неправильне написання ключових слів і т.д.

І звичайно не варто забувати про підвищення візуальної привабливості тексту, адже це відіграє також немаловажну роль.

<a name="завдання"></a>
## Завдання
**Загальне завдання:**

Розробити модуль підсвітки синтаксису DPS з використанням бібліотеки highlight.js.

**Функціональність:**

Користувач повинен мати можливість використовувати хайлайтер на власній машині та веб-сторінці.

<a name="положення"></a>
## Основні положення

Підсвітка синтаксису — виділення певним чином, певних елементів тексту, для покращення сприйняття його вмісту. Зазвичай застосовується до кодів програм, та розмітки документів. Розмітка синтаксису підтримується багатьма текстовими редакторами, та деякими сайтами, що публікують код.

## Highlight.js

Highlight.js - це супер DOM хайлайтер. Його ключовою особливстю є те що він намагається виявити мову програмування автоматично. Якщо автоматичне виявлення не працює, то ви можете вказати мову в атрибуті класу. Також highlight.js може працювати з багатомовним кодом.

### Ключові переваги highlight.js:

  * [152 мови та 72 стилі](https://highlightjs.org/static/demo/)
  * автоматичне визначення мови
  * виділення багатомовного коду
  * доступно для node.js
  * працює з будь-якою розміткою
  * сумісний з будь-якою js-структурою

Щоб використовувати highlight.js у своєму проекті, просто включіть файли CSS та JS та ініціалізуйте за допомогою:

```javascript
initHighlightingOnLoad()
```
Метод:

```html
<!-- Include library -->
<link rel="stylesheet" href="/path/to/styles/default.css">
<script src="/path/to/highlight.pack.js"></script>
<!-- Initialize highlight -->
<script>hljs.initHighlightingOnLoad();</script>
```

Необхідна розмітка повинна виглядати так:

```html
<pre><code class="html">Sample 2021 code for the bois</code></pre>
```

![alt text](images/highlightjsimage.png)

<a name="проектування"></a>
## Проектування

**Сценарій підсвітки тексту типу string**

| Ідентифікатор: | STRING |
| --- | --- |
| Назва: | Підсвітка тексту типу string |
| Учасники: | Користувач; Система |
| Передумови: | Користувач використав елементи виділенні лапками |
| Результат: | Користувач отримує певну підсвітку синтаксису |
| Виключні ситуації: | Текст знаходиться в середині коментаря |
| Основний сценарій: | 1. Користувач використовує текст виділений лапками.<br>2. Система ідентифікує даний текст окремим класом.<br>3. Система підсвічує даний текст певним кольором.<br>4. Користувач отримує певну підсвітку синтаксису.|

**Сценарій підсвітки коментарів**

| Ідентифікатор: | COMMENT |
| --- | --- |
| Назва: | Підсвітка коментарів |
| Участники: | Користувач; Система |
| Передумови: | Користувач використав елементи виділенні данним чином: // |
| Результат: | Користувач отримує певну підсвітку синтаксису |
| Виключні ситуації: | Символи '//' і подальший текст є 'string' класом |
| Основний сценарій: |  1. Користувач вписав текст після //.<br>2. Система ідентифікує даний текст окремим класом.<br>3. Система підсвічує даний текст певним кольором.<br>4. Користувач отримує певну підсвітку синтаксису.|

**Сценарій підсвітки розділових символів**

| Ідентифікатор: | SYMBOL |
| --- | --- |
| Назва: | Підсвітка розділових символів |
| Участники: | Користувач; Система |
| Передумови: | Користувач використав розділовий символ |
| Результат: | Користувач отримує певну підсвітку синтаксису |
| Виключні ситуації: | Текст знаходиться в середині коментаря, або ж є 'string' класом |
| Основний сценарій: |  1. Користувач використав розділовий символ.<br>2. Система ідентифікує даний текст окремим класом.<br>3. Система підсвічує даний текст певним кольором.<br>4. Користувач отримує певну підсвітку синтаксису.|

**Сценарій підсвітки слів-команд**

| Ідентифікатор: | TITLE |
| --- | --- |
| Назва: | Підсвітка команди |
| Участники: | Користувач; Система |
| Передумови: | Користувач використав 'ddl.', 'dml.', 'c.', 's.', 'services.'  |
| Результат: | Користувач отримує певну підсвітку синтаксису |
| Виключні ситуації: | Текст знаходиться в середині коментаря, або ж є 'string' класом |
| Основний сценарій: |  1. Користувач використав слова-команди.<br>2. Система ідентифікує даний текст окремим класом.<br>3. Система підсвічує даний текст певним кольором.<br>4. Користувач отримує певну підсвітку синтаксису.|



<a name="розробка"></a>
## Розробка

Розробка і подальше написання власного хайлайтера починається з розуміння структури та базового синтаксису мови програмування для якої власне і створюється хайлайтер.
Для початку потрібно розуміти, що будь-яка мова програмування, для якої ви будете створювати хайлайтер, складається з багатьох умовних частин. Такими частинами у більшості мов програмування виступають: 

	* ключові слова
	* коментарі
	* функції (процедури)
	* символи
	* класи та типи об'єктів та безліч інших складових коду

Ключовою особливістю саме DPS є інєкції html, text, xml, csv, json, що значною мірою підвищує складність завдання.


У Highlight.js колір тексту задається "режимом підсвітки". Кожен режим підсвітки може складатися з:

	* умови початку
	* умови закінчення
	* списку вміщених підрежимів
	* правил, регулярних виразів та ключових слів
	* інколи може містити деяку мову всередині іншої мови

Надалі розглядатимемо загальну структуру хайлайтеру highlight.js та її найважливіші складові:
```javascript
{
  case_insensitive: true, // чутливість до регістру
  keywords: 'for if while',
  contains: [
    {
      className: 'string',
      begin: '"', 
      end: '"'
    },
    hljs.COMMENT(
      '/\\*', // умова початку
      '\\*/', // умова кінця
      {
        contains: [
          {
            className: 'doc', 
	    begin: '@\\w+'
          }
        ]
      }
    )
  ]
}
```
### Ключові слова (Keywords)

У загальному випадку ключове слово – це засіб мови програмування, який вбудований в мову програмування і використовується для розробки програм на цій мові. Варто зазаначити, що багато мов мають деякі спільні ключові слова, так наприклад ключове слово 'for' використовується в Python, С, Java.  

Бібліотека Highlight.js дозволяє задавати перелік ключових слів декількома способами:

-списком через пробіл

-масивом

```javascript
{
  keywords: {
    keyword: 'else for if while', //Перший спосіб задання списку ключових слів - перелік у лапках через пробіл 
    literal: ['false','true','null'], //Другий спосіб - масивом.
    _relevance_only: 'one two three four'
  }
}
```

### Генерація підсвітки
Важливий той факт, що колір яким буде підсвічуватися текст ми не задаємо, ми лише вказуємо де міжі коментарів, межі тексту типу 'string', де ключові слова, а колір яким буде підсвічуватися даний текст визначає 'css' стиль, у бібліотеці highlight.js представлено безліч таких. В даному хайлайтері використано cтиль 'monokai-sublime'.

Для прикладу порівняння, як 'css' стиль змінює хайлайтер:

| Приклад 1: monokai-sublime | Приклад 2: srcery |
| --- | --- |
| ![Image alt](https://github.com/OhochyiRostik/Ohochyi_IPZ2/blob/main/Image3.png) | ![Image alt](https://github.com/OhochyiRostik/Ohochyi_IPZ2/blob/main/Image4.png) |


Атрибут `className` задає тип і відповідно колір підсвічуємого тексту, ось декілька аргументів, які можна сюди передавати:

	* "string"
	* "comment"
	* "variable"
	* "symbol"
	* "number"
	* "title"

```javascript
{
className:"symbol",
begin: /:|;|\.|&&|!|==|=>|<=|{|}|\(|\)|\[|\]|,|=|\|\||\$|`|\?>|<\?|<|>|\//,
}
```
Як видно з даного прикладу немаловажну роль у написанні хайлайтера відіграють регулярні вирази, адже саме за допомогою них задаються умови початку і кінця підсвічування синтаксису. 

Чудовими сайтами для їх вивчення та тренування відповідно є: [MND Web Docs](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions) та [Regexr](https://regexr.com/)

Давайте розглянемо регулярні вирази у наведеному вище прикладі:
Даний клас має виділяти різні символи в коді.
Вертикальна риса `|` позначатиме логічну дію 'OR'. Перед деякими символами також вставлено `\` - це символ екранації. Умовою кінця є опціональною, в даному випадку вона відсутня.


<a name="тестування"></a>
## Тестування
<a name="висновки"></a>
## Висновки
Провівши аналіз предметної області, порівнявши переваги та недоліки вже існуючих систем підсвічування синтаксису, враховуючи навчальну направленість проекту, було прийнято рішення створити власний хайлайтер для обраної мови Data Processing Script на базі бібліотеки highlight.js.
<a name="джерела"></a>
## Джерела
